fn array_random(M) {
    let i = 0
    const arr = []
    while i < M {
        i = i + 1
        arr << random()
    }
    return arr
}

fn join(a, b) {
    const c = []

    let i = 0
    const na = #a
    while i < na {
        c << a[i]
        i = i + 1
    }

    let j = 0
    const nb = #b
    while j < nb {
        c << b[j]
        j = j + 1
    }

    return c
}

fn quicksort(arr) {
    const n = #arr
    if n <= 1 { return arr }

    " min and max "

    let min = arr[0]
    let max = arr[0]
    let i = 1
    while i < n {
        let ai = arr[i]
        if ai > max { max = ai }
        if ai < min { min = ai }
        i = i + 1
    }

    " midpoint "
    if min == max { return arr }
    const mid = (min + max) / 2
    const upper = []
    const lower = []

    " pivot "
    i = 0
    while i < n {
        const e = arr[i]

        if e < mid { lower << e }
        else { upper << e }
        i = i + 1
    }

    return join(quicksort(lower), quicksort(upper))
}

const N = 1000
const A = []

let i = 0
while i < N {
    i = i + 1
    A << i
}

const before = clock()
"const B = quicksort(A)"
const B = A
const after = clock()
print("time taken")
print(after - before)

if #A != #B {
    print("not same size!")
}

return